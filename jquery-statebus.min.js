!function(t,e){"object"==typeof module&&module.exports?e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):e(t.jQuery||t.$)}(window||this,function(u){var c=u.extend,f=u({}),s={state:{},action:{},prevState:{}};function n(a,e,t,i,n){n&&i(a,{immediately:!0}),e&&(t=u.map(t.split?t.split(/\s+/):t,function(t){return e+"."+t}));var o=function(t,e,n){i(a,{actionName:e,args:n,immediately:!1})};return f.on(t=t.join?t.join(" "):t,o),function(){f.off(t,o)}}u.statebus=c(function(o,t,e){if(!o)throw new TypeError('[jquery-statebus] "namespace" is required.');var r=c({},t);r.action=c({},r.action),u.each(r.action,function(a,i){r.action[a]=function(){var t=u.makeArray(arguments),e=r.state,n=i.apply(r,t);return u.isPlainObject(n)&&(s.state[o]=r.state=c({},r.state,n),s.prevState[o]=r.prevState=e),f.trigger(o+"."+a,[a,t]),f.trigger(o+".all",[a,t]),n}}),e?f.off(o):(s.prevState[o]=null,c(r.state,s.state[o]),c(r.action,s.action[o]));return s.state[o]=r.state,s.action[o]=r.action,c(r,{on:u.proxy(n,null,r,o)})},s,{on:u.proxy(n,null,s,null),remove:function(t){delete s.state[t],delete s.action[t],delete s.prevState[t],f.off(t)}})});